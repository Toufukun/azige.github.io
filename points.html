<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
		<title>日麻点数计算</title>
	</head>
	<body>
		<script>
			function calculate(){
				var fan = parseInt(document.getElementById('fan').value)
				var fu = parseInt(document.getElementById('fu').value)
				var base = Math.pow(2, fan + 2) * fu
				var reserved = document.getElementById('reserved')
				
				if (base > 1900 && document.getElementById('kiriagemangan').checked){
					base = 2000
				}
				
				if (base >= 2000 || fan >= 5){
					if (fan <= 5){
						reserved.textContent = '满贯'
						base = 2000
					}else if (fan <= 7){
						reserved.textContent = '跳满'
						base = 3000
					}else if (fan <= 10){
						reserved.textContent = '倍满'
						base = 4000
					}else if (fan <= 12){
						reserved.textContent = '三倍满'
						base = 6000
					}else{
						reserved.textContent = '累计役满'
						base = 8000
					}
				}else{
					reserved.textContent = '　'
				}
				
				var oyatsumo = document.getElementById('oyatsumo')
				var oyaron = document.getElementById('oyaron')
				var kotsumo = document.getElementById('kotsumo')
				var koron = document.getElementById('koron')
				var sanma = document.getElementById('sanma')
				if (sanma.checked){
					oyatsumo.textContent = foo(base * 3)
					kotsumo.textContent = foo(base * 1.5) + '·' + foo(base * 2.5)
				}else{
					oyatsumo.textContent = foo(base * 2)
					kotsumo.textContent = foo(base) + '·' + foo(base * 2)
				}
				oyaron.textContent = foo(base * 6)
				koron.textContent = foo(base * 4)
			}
			
			// 向上取整到千位
			// TODO: 重命名此方法
			function foo(n){
				if (n % 100 > 0){
					return (Math.ceil(n / 100)) * 100
				}
				return n
			}
			
			function showComment(boxName){
				var box = document.getElementById(boxName)
				var comment = document.getElementById(boxName + 'Comment')
				comment.hidden = !box.checked
			}
		</script>
		<select id="fan">
			<option>1</option>
			<option>2</option>
			<option>3</option>
			<option>4</option>
			<option>5</option>
			<option>6</option>
			<option>7</option>
			<option>8</option>
			<option>9</option>
			<option>10</option>
			<option>11</option>
			<option>12</option>
			<option>13</option>
		</select>
		翻
		<select id="fu">
			<option>20</option>
			<option>25</option>
			<option>30</option>
			<option>40</option>
			<option>50</option>
			<option>60</option>
			<option>70</option>
			<option>80</option>
			<option>90</option>
			<option>100</option>
			<option>110</option>
		</select>
		符
		<input type="button" value="计算" onclick="calculate()">
		<br>
		<input id="kiriagemangan" type="checkbox" onclick="showComment('kiriagemangan')">进位满贯（切り上げ満貫）
		<span id="kiriagemanganComment" hidden="true">—— 基本点超过1900时即视为满贯。</span>
		<br>
		<input id="sanma" type="checkbox" onclick="showComment('sanma')">三麻
		<span id="sanmaComment" hidden="true">—— 闲家自摸使用3:5分配法，即两家平分缺的那一家应付的点数。</span>
		<table>
			<tr>
				<td id="reserved" width="80">　</td>
			</tr>
			<tr height=30></tr>
			<tr>
				<td>庄家</td>
			</tr>
			<tr>
				<td>自摸</td>
				<td id="oyatsumo"></td>
			</tr>
			<tr>
				<td>荣和</td>
				<td id="oyaron"></td> 
			</tr>
			<tr height=30></tr>
			<tr>
				<td>闲家</td>
			</tr>
			<tr>
				<td>自摸</td>
				<td id="kotsumo"></td>
			</tr>
			<tr>
				<td>荣和</td>
				<td id="koron"></td>
			</tr>
		</table>
	</body>
</html>